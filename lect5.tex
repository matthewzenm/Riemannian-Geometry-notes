\chapter{Comparison Theorems}
In this lecture, we first state and prove Rauch comparison theorem.
Then we discuss cut points and distance function, as preparation for Hessian and Laplace comparison theorem.
Using Rauch comparison theorem as a model, we then state and prove Hessian, Laplace and Bishop--Gromov relative comparison theorems.
Finally, as an application, we prove Cheng's maximal radius theorem.

\section{Rauch Comparison Theorem}

We first state and prove the Rauch comparison theorem.

\begin{thm}[Rauch comparison]\label{Rauch}
    Let $M^n,\tilde{M}^n$ be Riemannian manifolds, $\gamma:[0,a]\to M$, $\tilde{\gamma}:[0,a]\to\tilde{M}$ be unit speed geodesics, and $J,\tilde{J}$ be Jacobi fields along $\gamma,\tilde{\gamma}$ respectively, such that $J(0)=\tilde{J}(0)=0$, $\langle\dot{J}(0),\dot{\gamma}(0)\rangle=\left\langle\dot{\tilde{J}}(0),\dot{\tilde{\gamma}}(0)\right\rangle$, $|\dot{J}(0)|=\left|\dot{\tilde{J}}(0)\right|$.
    Assume that
    \begin{enumerate}[(1)]
        \item $\gamma$ has no conjugate points of $\gamma(0)$ along $\gamma$;
        \item $K_\gamma(\dot{\gamma},v)\geq K_{\tilde{\gamma}}\left(\dot{\tilde{\gamma}},\tilde{v}\right)$ with $|v|=|\tilde{v}|=1$.
    \end{enumerate}
    Then $|J(t)|\leq|\tilde{J}(t)|$ for all $t\in[0,a]$.
\end{thm}

\begin{rem}
    Before giving the proof of the theorem, we notice that when $\dim M=\dim\tilde{M}=2$, the theorem reduces to the Liouville--Sturm comparison theorem in ODE theory.
\end{rem}

\begin{proof}[Proof of Theorem~\ref{Rauch}]
    Decompose $J,\tilde{J}$ into $J^\perp(t)+(at+b)\dot{\gamma}(t)$, $\tilde{J}^\perp(t)+(\tilde{a}t+\tilde{b})\dot{\tilde{\gamma}}(t)$ respectively.
    Since $J(0)=\tilde{J}(0)=0$, we have $b=\tilde{b}=0$;
    Moreover, since $\langle\dot{J}(0),\dot{\gamma}(0)\rangle=\left\langle\dot{\tilde{J}}(0),\dot{\tilde{\gamma}}(0)\right\rangle$, we have $a=\tilde{a}$.
    Since $|J^\perp|^2=|J|^2-(at)^2$, $|\tilde{J}^\perp|^2=|\tilde{J}|^2-(\tilde{a}t)^2$,
    we can just compare $J^\perp$ and $\tilde{J}^\perp$.
    So we assume without loss of generality that $J,\tilde{J}$ are normal Jacobi fields, that is, $\dot{J}(0)\perp\dot{\gamma}(0)$, $\dot{\tilde{J}}(0)\perp\dot{\tilde{\gamma}}(0)$.

    Let $f(t)=|J(t)|^2$, $\tilde{f}(t)=|\tilde{J}(t)|^2$.
    By l'Hospital's rule, we have
    \[\lim_{\varepsilon\to 0}\frac{\tilde{f}(\varepsilon)}{f(\varepsilon)}=1,\]
    hence only need to show $\tilde{f}/f$ is monotonically increasing, which is equivalent to
    \[\frac{\dot{\tilde{f}}}{\tilde{f}}\geq\frac{\dot{f}}{f}\iff\frac{\left\langle\dot{\tilde{J}},\tilde{J}\right\rangle}{\left|\tilde{J}\right|^2}\geq\frac{\langle\dot{J},J\rangle}{|J|^2}.\]
    We can check the last inequality pointwisely, so we can scale the Jacobi fields to make $|\tilde{J}|=|J|$.
    Then we write the inequality into a lemma.
\end{proof}

\begin{lem}\label{compare jacobi fields}
    If $J,\tilde{J}$ are Jacobi fields along $\gamma,\tilde{\gamma}$ respectively, with $J(0)=\tilde{J}(0)=0$, $\dot{J}(0)\perp\dot{\gamma}(0)$, $\dot{\tilde{J}}(0)\perp\dot{\tilde{\gamma}}(0)$, and $|J(c)|=|\tilde{J}(c)|$.
    Moreover, the conditions (1) and (2) in Theorem~\ref{Rauch}~hold, then $\left\langle\dot{\tilde{J}}(c),\tilde{J}(c)\right\rangle\geq\langle\dot{J}(c),J(c)\rangle$.
\end{lem}
\begin{proof}
    First we notice that
    \[\langle\dot{J}(c),J(c)\rangle=I_{[0,c]}(J,J),\ \left\langle\dot{\tilde{J}}(c),\tilde{J}(c)\right\rangle=I_{[0,c]}\left(\tilde{J},\tilde{J}\right).\]
    From now on we will simply use $I$ as $I_{[0,c]}$.
    (Here we abuse the notation, using same $I$ to denote index form on different curves.
    We will write the curve in subscript in case of ambiguous if necessary.)
    Let $\{e_1(t),\cdots,e_{n-1}(t),\dot{\gamma}(t)\}$, $\left\{\tilde{e}_1(t),\cdots,\tilde{e}_{n-1}(t),\dot{\tilde{\gamma}}(t)\right\}$ be parallel orthonormal frames along $\gamma,\tilde{\gamma}$ respectively, such that $J(c)=\alpha e_1(c)$, $\tilde{J}(c)=\alpha\tilde{e}_1(c)$.
    Let
    \[J(t)=\sum_{i=1}^{n-1}h_i(t)e_i(t),\ \tilde{J}(t)=\sum_{i=1}^{n-1}\tilde{h}_i(t)\tilde{e}_i(t),\]
    then $h_i(c)=\tilde{h}_i(c)=0$, $i=2,\cdots,n-1$.
    Define $U(t)=\sum_{i=1}^{n-1}\tilde{h}_i(t)e_i(t)$ along $\gamma$, then $U(c)=J(c)$, $U(0)=J(0)=0$, $|U(t)|=|\tilde{J}(T)|$.
    Thus by Index Lemma, $I_\gamma(J,J)\leq I_\gamma(U,U)$.
    However, we have
    \begin{align*}
        I_\gamma(U,U)&=\int_0^c(|\dot{U}|^2-\langle R(\dot{\gamma},U)\dot{\gamma},U\rangle)\d{t}\\
        &=\int_0^c\left(\left|\dot{\tilde{J}}\right|^2-|U|^2K(\dot{\gamma},U/|U|)\right)\d{t}\\
        &\leq\int_0^c\left(\left|\dot{\tilde{J}}\right|^2-\left|\tilde{J}\right|K\left(\dot{\tilde{\gamma}},\tilde{J}/|\tilde{J}|\right)\right)\d{t}\\
        &=I_{\tilde{\gamma}}(\tilde{J},\tilde{J})
    \end{align*}
    Thus we have $\left\langle\dot{\tilde{J}}(c),\tilde{J}(c)\right\rangle\geq\langle\dot{J}(c),J(c)\rangle$.
\end{proof}

\begin{cor}
    If Riemannian manifold $(M^n,g)$ satisfies $\operatorname{Sect}\leq 0$, then $|J(t)|\geq t$, that is, $\left|\exp_{p*}|_v(w)\right|\geq|w|$.
\end{cor}
\begin{proof}
    Compare $(M^n,g)$ with Euclidean space $(\mathbb{R}^n,\delta)$.
\end{proof}

The corollary implies the following important theorem.
\begin{thm}\label{C-H 1}
    Let $M$ be a complete Riemannian manifold with $\operatorname{Sect}\leq 0$, $p\in M$ be any point.
    Then $M$ has no conjugate points of $p$.
\end{thm}

Theorem~\ref{C-H 1}~is known as the first part of the celebrated Cartan--Hadamard Theorem.
We state the rest part of the theorem as follows.
\begin{thm}[Cartan--Hadamard]
    Let $M^n$ be a complete Riemannian manifold with $\operatorname{Sect}\leq 0$, then the universal cover of $M$ is diffeomorphic to $\mathbb{R}^n$.
\end{thm}
\begin{proof}[Part of the Proof]
    Without loss of generality, we assume $M$ is simply connected.
    Then we only need to show $M$ is diffeomorphic to $\mathbb{R}^n$.
    Since $M$ is complete, $\exp_p:T_pM\to M$ is surjective, and by Theorem~\ref{C-H 1}, the $\exp_p$ is nondegenerate.
    Thus $\exp_p$ is a local isometry between $(T_pM,\exp_p^*g)\to(M,g)$.
    We show that $\exp_p^*g$ is complete.
    Let $\gamma_v(t):[0,+\infty)\to T_pM, t\mapsto vt$ for any unit vector $v\in T_pM$, then $\exp_p(\gamma)$ is a geodesic in $(M,g)$.
    By the definition of $\exp_p^*g$, $\gamma_v(t)$ is a geodesic in $(T_pM,\exp_p^*g)$, hence the exponential map $\exp_0:T_0(T_pM)\to T_pM$ is well-defined at $0\in T_pM$.
    Hence by Hopf--Rinow Theorem, $\exp_p^*g$ is complete.
    Now the proof reduces to the following proposition.
\end{proof}

\begin{prop}
    Let $f:M\to N$ be local isometry between Riemannian manifolds, with $M$ complete.
    Then $N$ is complete and $f$ is a covering map.
\end{prop}

We stop here, and refer to Peter Peterson's \emph{Riemannian Geometry}, 3rd ed., Lemma 5.6.4.

We mention something more.
Cartan--Hadamard Theorem can be used to prove the uniqueness of space forms, that is, simply connected complete constant sectional curvature Riemannian manifolds are unique up to an isometry.
This can be found in Wu Hung--Hsi et.\ al.'s \emph{Introduction to Riemannian Geometry}, Chapter 5.

\section{Cut Points and Distance Function}

From this section, we assume the Riemannian manifold $(M,g)$ appear in the context is complete.

We start this section by an example.

\begin{eg}
    Consider the cylinder $M=\mathbb{S}^1\times\mathbb{R}$.
    $M$ is flat, that is, has constant sectional curvature $0$, hence has no conjugate points (Cartan--Hadamard).
    Let $\gamma:[0,2\pi]\to M$ be a generatrix circle, then $\gamma$ is a geodesic.
    Denote $p=\gamma(0)$, $q=\gamma(\pi)$.
    Then $\gamma|_{[0,\pi]}$ is a length-minimizing geodesic joining $p$ and $q$.
    But it is not the only length-minimizing geodesic joining $p$ and $q$, since $-\gamma|_{[\pi,2\pi]}$ is another one.
    Then $q$ spoils the uniqueness of length-minimizing geodesic starts from $p$, without being conjugate to $p$.
    This inspires us to define the notion of \emph{cut points}.
\end{eg}

Given $v\in T_pM$, $|v|=1$, $\gamma_v:[0,+\infty)\to M$ be a geodesic with $\gamma(0)=p$, $\dot{\gamma}_v(0)=v$.
Notice that $\gamma_v|_{[0,t_0]}$ is length-minimizing if $d(p,\gamma_v(t_0))=t_0$.
If $\gamma_v$ contains conjugate points, then $\gamma_v$ is in general not locally length-minimizing.

\begin{defn}
    Under above settings, let $t_0=\sup\{t\in(0,+\infty)|\ d(p,\gamma_v(t))=t\}$.
    If $t_0<+\infty$, we call $\gamma_v(t_0)$ the \textbf{cut point} of $p$ along $\gamma_v$.
    Define $\Cut(p)$ to be the set of all cut points of $p$, called the \textbf{cut locus} of $p$.
\end{defn}

By definition and Jacobi's theorem, the first conjugate point (if exists) must be the cut point.
But converse is in general not true (See Example~\ref{eg of cut pts}.)
The following proposition characterizes cut points.

\begin{prop}
    Let $\gamma$ be a unit speed geodesic.
    If $\gamma(t_0)$ is the cut point of $p$ along $\gamma$, then either $\gamma(t_0)$ is conjugate to $p$ along $\gamma$, or there exists two length-minimizing geodesics from $p$ to $\gamma(t_0)$.
\end{prop}
\begin{proof}
    Let the initial vector of $\gamma$ be $v$.
    Choose a sequence $\{t_i\}$ decreasingly converges to $t_0$.
    Let $\sigma_i$ be the unit speed length-minimizing geodesic joining $p$ and $\gamma(t_i)$, with initial vector $v_i$.
    Define $b_i=d(p,\gamma(t_i))=L(\sigma_i)$, then $\sigma_i$ is defined on $[0,b_i]$.
    Hence up to a subsequence, we have $b_iv_i\to t_0y$, where $|y|=1$.
    If $v\neq y$, then $\sigma_i\to\sigma(t)=\exp_p(ty)$ (up to a subsequence), thus $\sigma,\gamma$ are two length-minimizing geodesics joining $p$ and $\gamma(t_0)$.
    If $v=y$, then $\exp_p(b_iv_i)=\gamma(t_i)=\exp_(t_iv)$, $\exp_p$ is not one-to-one near $t_0y$.
    Hence $\exp_{p*}|_{t_0y}$ is degenerate, at $\exp_p(t_0y)=\gamma(t_0)$, that is, $\gamma(t_0)$ is conjugate to $p$.
\end{proof}

\begin{eg}\label{eg of cut pts}
    \begin{enumerate}[(1)]
        \item Let $M=\mathbb{S}^n$.
        Then the south pole is conjugate to north pole, as well as the cut point of north pole.
        \item Let $M=\mathbb{RP}^n$.
        For simplicity we take $n=2$.
        We regard $\mathbb{RP}^2$ as the upper hemisphere with identifying equator's antipodal points (This is actually CW decomposition).
        Then from the north pole we move along a ``great circle'' to a point $q$ on the equator, the path is a length-minimizing geodesic.
        However, the path on the same ``great circle'' but on the other side is also a length-minimizing geodesic, so $p$ is the cut point of north pole (along this geodesic).
        But by the naturality of exponential map, $q$ is not conjugate to north pole, so this is an example of cut point not being conjugate point.
        \item Let $M=\mathbb{R}^2/\mathbb{Z}^2$ be the flat torus.
        Let $[0,1]\times[0,1]$ be the fundamental region, and denote $p=(0,0)=(0,1)$.
        Then $\gamma(t)=(t,0)$ is a geodesic.
        Notice that if $t_0>1/2$, $\gamma(t)$ is not the length-minimizing geodesic joining $p$ and $(t_0,0)$, since $\sigma(t)=(1-t,0)$ is the length-minimizing geodesic joining $p$ and $(t_0,0)$.
        By the same reason, we have the cut locus of $p$ is $\{1/2\}\times[0,1/2]\cup[0,1/2]\times\{1/2\}$.
    \end{enumerate}
\end{eg}

Let $S_p\subset T_pM$ be the unit sphere.
For any $v\in S_p$, denote $\gamma_v:[0,+\infty)\to M$ be the geodesic with $\dot{\gamma}(0)=v$.
We define a function
\[\tau:S_p\to(0,+\infty],\ \tau(v)=\begin{cases}
    +\infty, & \gamma_v\ \text{contains no cut point},\\
    t_0, & \gamma_v(t_0)\ \text{is the cut point of }p.
\end{cases}\]

We have the following properties of $\tau$ and cut locus.
\begin{prop}
    Let $\tau$ be defined as above. We have
    \begin{enumerate}[(1)]
        \item $\tau$ is a continuous function.
        \item $\Cut(p)$ is closed in $M$.
        \item $\Cut(p)$ is of zero-measure.
    \end{enumerate}
\end{prop}
The proof is complicated, so we refer to Wu Hung--Hsi et.\ al.'s \emph{Introduction to Riemannian Geometry}, Chapter 10.

\begin{prop}
    Denote $\Sigma(p)=\{tv|\ v\in S_p,\ t\in[0,\tau(v))\}$, then
    \[\exp_p:\Sigma(p)\to\exp_p(\Sigma(p))\]
    is a diffeomorphism, and $M=\exp_p(\Sigma(0))\sqcup\Cut(p)$.
\end{prop}
\begin{proof}
    Since there is no cut points of $p$ in $\Sigma(p)$ by the definition of $\tau$, there is no conjugate points of $p$ in $\Sigma(p)$.
    Hence $\exp_{p*}$ is nondegenerate in $\Sigma(p)$, $\exp_{p}$ is an immersion.
    We need to show $\exp_p$ is one-to-one.
    For if not, let $\exp_p(t_1v_1)=\exp_p(t_2v_2)=:q$ for $v_1\neq v_2$.
    Let $\gamma_1(t)=\exp_p(tv_1)$, $\gamma_2(t)=\exp_p(tv_2)$.
    Since $M\backslash\Cut(p)$ is open, there is a neighborhood of $q$ contained in $\Sigma(p)$, hence there is an $\varepsilon>0$ such that $\gamma_2(t_2+\varepsilon)=:r\in\Sigma(p)$.
    Then $\gamma_1\cup\gamma_2|_{[t_2,t_2+\varepsilon]}$ realizes the length-minimizing path from $p$ to $r$, hence by the first variation formula, it is a geodesic.
    But $\gamma_1\cup\gamma_2|_{[t_2,t_2+\varepsilon]}$ is not smooth at $q$ (otherwise $-\dot{\gamma}_1(t_1)=-\dot{\gamma}_2(t_2)$ will lead to the same geodesic), contradicting to a geodesic must be smooth.
    Thus we proved the first claim.

    The second claim is clear.
\end{proof}

Now we define the injective radius of a point and a manifold.
\begin{defn}
    Let $M$ be a Riemannian manifold, $p\in M$, we define the \textbf{injective radius} by
    \begin{gather*}
        \inj(p):=\sup\{r\in(0,+\infty)|\ B_r(p)\subset\Sigma(p)\}\\
        \inj(M):=\inf_{p\in M}\inj(p)
    \end{gather*}
\end{defn}

A simple observation leads to the following property.
\begin{prop}
    If $M$ is compact, then $\inj(M)>0$.
\end{prop}

However, if the manifold is not compact, the injective radius may be $0$.
\begin{eg}
    Let's consider the surface of revolution by rotating $y=1/x$ $(x>0)$ around $x$-axis, then the point $(x,1/x,0)$ has injective radius $\pi/x$, which converges to $0$ as $x\to+\infty$.
    Hence the surface has injective radius $0$.
\end{eg}

We now discuss some differential properties of distance function.

Let $p\in M$, denote $d_p:M\to\mathbb{R}$, $d_p(q)=d(p,q)$.
By triangle inequality, $d_p$ is Lipschitz continuous.
But we have more to say.
\begin{prop}\label{dp smooth}
    Let $p\in M$, we have $d_p\in C^\infty(M\backslash(\{p\}\cup\Cut(p)))$.
    Moreover, $|\nabla d_p|=1$ at where $d_p$ is smooth.
\end{prop}
\begin{proof}
    We just need to calculate $\nabla d_p$ in $M\backslash(\{p\}\cup\Cut(p))$.
    Let $q\in M\backslash(\{p\}\cup\Cut(p))$, and $\exp_p(lv)=q$, $|v|=1$.
    Then there exists a neighborhood $U\subset T_pM$ of $\{tv\in T_pM|\ t\in[0,l]\}$ such that $\exp_p(U)\subset M\backslash\Cut(p)$.
    Now for $z\in U$, we have $d(\exp_p(z),p)=|z|$.
    Thus by taking the geodesic polar coordinate $(U,\varphi)$, we have $d_p(\varphi^{-1}(r,\theta))=r$.
    Therefore we have
    \begin{align*}
        \nabla d_p=g^{rr}\frac{\partial{d_p}}{\partial{r}}\frac{\partial{}}{\partial{r}}+g^{ij}\frac{\partial{d_p}}{\partial{\theta^i}}\frac{\partial{}}{\partial{\theta^j}}=\frac{\partial{}}{\partial{r}}.
    \end{align*}
    (Recall $g=\d{r^2}+g_{ij}\d{\theta^i}\otimes\d{\theta^j}$ under polar coordinate.)
    Thus $d_p$ is smooth at $q\in M\backslash(\{p\}\cup\Cut(p))$, and $|\nabla d_p|=1$.
\end{proof}

Now we compute the Hessian of $d_p$ for some situation.

\begin{prop}\label{hess dp in tangential}
    We have $\nabla^2d_p(\nabla d_p,X)=0$ for any $X\in T_qM$, $q\in M\backslash(\{p\}\cup\Cut(p))$.
\end{prop}
\begin{proof}
    Let's just calculate
    \begin{align*}
        \nabla^2d_p(\nabla d_p,X)&=X(\nabla d_p)(d_p)-(\nabla_X(\nabla d_p))(d_p)\\
        &=X\langle\nabla d_p,\nabla d_p\rangle-\langle\nabla_X(\nabla d_p),\nabla d_p\rangle\\
        &=X\langle\nabla d_p,\nabla d_p\rangle-\frac{1}{2}X\langle\nabla d_p,\nabla d_p\rangle\\
        &=0.\quad\text{(Since $|\nabla d_p|=1$)}\qedhere
    \end{align*}
\end{proof}

\begin{prop}\label{hess dp in other}
    Let $J$ be a Jacobi field along geodesic $\gamma$ such that $J(0)=0$, $J\perp\dot{\gamma}$.
    Then
    \[\nabla^2d_p|_{\gamma(t)}(J(t),J(t))=\langle\dot{J}(t),J(t)\rangle\quad(t<\tau(\dot{\gamma}(0)))\]
\end{prop}
\begin{proof}
    First we notice that $\nabla d_p=\dot{\gamma}$ (One can show this by using geodesic polar coordinate as in Proposition~\ref{dp smooth}).
    Then let's calculate
    \begin{align*}
        \nabla^2d_p|_{\gamma(t)}(J(t),J(t))&=J\langle J,\nabla d_p\rangle-\langle\nabla_JJ,\nabla d_p\rangle\\
        &=\langle J,\nabla_J(\nabla d_p)\rangle\\
        &=\langle J,\nabla_{\nabla d_p}J\rangle\quad\text{(torsion-freeness)}\\
        &=\langle J,\dot{J}\rangle.\qedhere
    \end{align*}
\end{proof}

Now we are well-prepared to march towards Hessian comparison theorem and Lap\-lace comparison theorem.

\section{Hessian and Laplace Comparison Theorems}

We first state and prove Hessian comparison theorem.
\begin{thm}[Hessian comparison]
    Let $\gamma:[0,l]\to M$, $\tilde{\gamma}:[0,l]\to M$ be geodesics without cut points of $\gamma(0)$ and $\tilde{\gamma}(0)$ respectively.
    Assume $K_{\gamma(t)}(\dot{\gamma}(t),v)\geq K_{\tilde{\gamma}(t)}\left(\dot{\tilde{\gamma}}(t),\tilde{v}\right)$ for $|v|=|\tilde{v}|=1$.
    Then $\nabla^2d_p(X,X)\leq\tilde{\nabla}^2\tilde{d}_{\tilde{p}}\left(\tilde{X},\tilde{X}\right)$, for all $X\in T_{\gamma(t)}M$, $\tilde{X}\in T_{\tilde{\gamma}(t)}M$, with $|X|=|\tilde{X}|$, $\langle X,\dot{\gamma}\rangle=\left\langle\tilde{X},\dot{\tilde{\gamma}}\right\rangle$.
\end{thm}
\begin{proof}
    By Proposition~\ref{hess dp in tangential}, we can assume without loss of generality that $X\perp\dot{\gamma}$, $\tilde{X}\perp\dot{\tilde{\gamma}}$.
    Let $J,\tilde{J}$ be normal Jacobi fields on $\gamma,\tilde{\gamma}$ such that $J(0)=0,J(t)=X$ and $\tilde{J}=0,\tilde{J}(t)=\tilde{X}$.
    Then by Proposition~\ref{hess dp in other}, we have
    \[\nabla^2d_p(X,X)=\langle\dot{J}(t),J(t)\rangle,\ \tilde{\nabla}^2\tilde{d}_{\tilde{p}}\left(\tilde{X},\tilde{X}\right)=\left\langle\dot{\tilde{J}}(t),\tilde{J}(t)\right\rangle.\]
    Now $J,\tilde{J}$ satisfy the assumptions of Lemma~\ref{compare jacobi fields}, hence we have
    \[\nabla^2d_p(X,X)=\langle\dot{J}(t),J(t)\rangle\leq\left\langle\dot{\tilde{J}}(t),\tilde{J}(t)\right\rangle=\tilde{\nabla}^2\tilde{d}_{\tilde{p}}\left(\tilde{X},\tilde{X}\right).\qedhere\]
\end{proof}

\begin{eg}
    We compute $\nabla^2d_p$ on constant sectional curvature manifolds.
    As usual we scale the metric to make $K=0,1,-1$.
    Then the results are
    \[\nabla^2d_p=\begin{cases}
        \frac{1}{d_p}(g-\d(d_p)\otimes\d(d_p)), & K=0,\\
        \cot{d_p}(g-\d(d_p)\otimes\d(d_p)), & K=1,\\
        \coth{d_p}(g-\d(d_p)\otimes\d(d_p)), & K=-1,
    \end{cases}\]
    where $g$ is the metric tensor, and $\d(d_p)$ is the exterior differential of $d_p$.
\end{eg}

Now we state the Laplace comparison theorem.
\begin{thm}
    Let $(M^n,g)$ be a Riemannian manifold, $M_K^n$ be a Riemannian manifold with constant sectional curvature $K$.
    Let $\gamma:[0,l]\to M$, $\gamma_K:[0,l]\to M$ be geodesics without cut points.
    Assume $\Ric\geq(n-1)Kg$, then $\Delta d_p|_{\gamma(l)}\leq\Delta_kd_k|_{\gamma_K(l)}$.
\end{thm}

\begin{rem}
    Before giving the proof, we give some remark on the theorem.
    The theorem has a relatively weaker assumption that only Ricci curvature is bounded below, so we cannot copy the proof of Rauch comparison theorem as we did in Hessian comparison theorem.
    Moreover, the conclusion is also weakened (only compare to space forms) correspondingly.
    However, we can modify the proof of Bonnet--Myers theorem to obtain a proof of Laplace comparison theorem.
\end{rem}
\begin{proof}
    Let $\{e_1,\cdots,e_{n-1},e_n=\dot{\gamma}(l)\}$, $\{e_1^K,\cdots,e_{n-1}^K,e_n^K=\dot{\gamma}_K(l)\}$ be orthonormal bases of $T_{\gamma(l)}M$, $T_{\gamma_K(l)}M_K$ respectively.
    Let $J_i,J_i^K$ be Jacobi fields such that $J_i(0)=0,J_i(l)=e_i$ and $J_i^K(0)=0,J_i^K(l)=e_i^K$, for $i=1,\cdots,n-1$.
    Then by Proposition~\ref{hess dp in tangential}~and Proposition~\ref{hess dp in other}, we have
    \begin{align*}
        \Delta d_p|_{\gamma(l)}&=\sum_{i=1}^{n-1}\nabla^2d_p|_{\gamma(l)}(J_i,J_i)\\
        &=\sum_{i=1}^{n-1}\langle\dot{J},J\rangle\\
        &=\sum_{i=1}^{n-1}I(J_i,J_i),
    \end{align*}
    and similarly $\Delta_Kd_K=\sum_{i=1}^{n-1}I(J_i^K,J_i^K)$.
    We need to show that 
    \[\sum_{i=1}^{n-1}I(J_i,J_i)\leq\sum_{i=1}^{n-1}I(J_i^K,J_i^K).\]
    Let $\{e_i(t)\}$, $\{e_i^K(t)\}$ be parallel, then
    \[J^K_i(t)=\sum_{j=1}^{n-1}h_{ij}(t)e_j^K(t),\ i=1,\cdots,n-1,\]
    where $h_{ij}(t)=f_K(t)\delta_{ij}$, $\ddot{f}_K+Kf_K=0$.
    Define $U_i=\sum_{j=1}^{n-1}h_{ij}(t)e_j(t)$ along $\gamma$ in $M$, $i=1,\cdots,n-1$.
    Then $J_i(0)=U_i(0)=0$, $J_i(l)=U_i(l)$.
    By Index Lemma, we have
    \[\sum_{i=1}^{n-1}I(J_i,J_i)\leq\sum_{i=1}^{n-1}(U_i,U_i).\]
    Moreover, we have
    \begin{gather*}
        I(U_i,U_i)=\int_0^l\left(|\dot{U}_i|^2-\langle R(\dot{\gamma},U_i)\dot{\gamma},U_i\rangle\right)\d{t},\\
        I(J_i^K,J_i^K)=\int_0^l\left(|\dot{J}_i^K|^2-\left\langle R(\dot{\gamma}_K,J_i^K)\dot{\gamma}_K,J_i^K\right\rangle\right)\d{t},
    \end{gather*}
    and $|\dot{U}_i|^2=|\dot{J}_i^K|^2$ for $i=1,\cdots,n-1$.
    Now we have
    \begin{align*}
        \sum_{i=1}^{n-1}\langle R(\dot{\gamma},U_i)\dot{\gamma},U_i\rangle&=f_K^2(t)\langle R(\dot{\gamma},e_i)\dot{\gamma},e_i\rangle\\
        &=f^2_K(t)\langle\Ric(\dot{\gamma}),\dot{\gamma}\rangle\\
        &\geq f^2_K(t)(n-1)\\
        &=\sum_{i=1}^{n-1}\left\langle R(\dot{\gamma}_K,J_i^K)\dot{\gamma}_K,J_i^K\right\rangle.
    \end{align*}
    This implies the conclusion.
\end{proof}

\begin{rem}
    \begin{enumerate}[(1)]
        \item There is a conclusion that if $q$ lies in the geodesic sphere $B_r(p)=\{d_p=r\}$, then $\Delta d_p(q)=H_{B_r(p)}(q)$, where $H_{B_r(p)}(q)$ is the mean curvature of $B_r(p)$ at $q$.
        So Laplace comparison theorem can be also regarded as a comparison theorem of mean curvature.
        \item We notice that the equality holds in Laplace comparison theorem if and only if $K(\dot{\gamma},v)=K$ for any $|v|=1$, $v\perp\dot{\gamma}$.
        \item The case of $K=0$ is $\Delta d_p\leq\frac{n-1}{d_p}$.
        This inequality also holds in the sence of distribution, that is, for any $\varphi\in C^\infty_c(M)$, $\varphi\geq 0$, we have
        \[\int_Md_p\Delta\varphi\leq\int_M\frac{n-1}{d_p}\cdot\varphi.\]
        For a proof, we refer to Schoen, Yau's \emph{Lectures on Differential Geometry}, Proposition 1.1 in Chapter 1.
    \end{enumerate}
\end{rem}

\section{Volume Comparison Theorem}
In this section we assume all the manifolds appear are orientable.

We first introduce the Riemann volume form.
\begin{defn}
    Let $(M^n,g)$ be a Riemannian manifold, define an $n$-form $\d\Vol_g$ as 
    \[\d\Vol_g(e_1,\cdots,e_n)=1\]
    for an orthonormal basis $\{e_i\}$ in $T_pM$ for any $p\in M$.
    $\d\Vol_g$ is call \textbf{Riemann volume form}.
\end{defn}

Since if $(e_1',\cdots,e_n')=(e_1,\cdots,e_n)A$, for any $n$-form $\omega$ we have
\[\omega(e_1',\cdots,e_n')=(\det{A})\omega(e_1,\cdots,e_n),\]
the Riemann volume form is well-defined.

Locally we have
\[\d\Vol_g=\sqrt{\det(g_{ij})}\d{x^1}\wedge\cdots\wedge\d{x^n}.\]

\begin{defn}
    Let $\Omega\subset M$, the \textbf{volume} of $\Omega$ is defined as
    \[\Vol(\Omega):=\int_\Omega\d\Vol_g.\]
    If $M$ is compact, we can also define
    \[\Vol(M):=\int_M\d\Vol_g.\]
\end{defn}

Integration on manifold is defined by partition of unity, this is almost impossible to compute.
However, we have a local chart $(\Sigma(p),\exp_p^{-1})$ with $M\backslash\Sigma(p)$ is of zero-measure.
So we have
\[\int_M\d\Vol_g=\int_{\exp_p(\Sigma(p))}\d\Vol_g=\int_{\Sigma(p)}\exp_p^*(\d\Vol_g).\]

We now calculate Riemann volume form in geodesic polar coordinate.
Let $J_i$ be Jacobi fields with $J_i(0)=0$, $J_i(r,\theta)=\partial_{\theta^i}$ for $i=1,\cdots,n$.
Then
\[\d\Vol_g=\sqrt{\det(g_{ij})}\d{r}\wedge\d{\theta^1}\wedge\cdots\wedge\d{\theta^{n-1}},\]
and denote $\mathscr{J}=\sqrt{\det(g_{ij})}$.

\begin{prop}\label{Laplace of distance function}
    We have $\frac{\partial{}}{\partial{r}}\log\mathscr{J}=\Delta d_p$.
\end{prop}
\begin{proof}
    We calculate
    \begin{align*}
        \frac{\partial{}}{\partial{r}}\log\mathscr{J}&=\frac{1}{2}\frac{1}{\det(g_{ij})}\det(g_{ij})g^{ij}(\langle\dot{J}_i,J_j\rangle+\langle J_i,\dot{J_j}\rangle)\\
        &=g^{ij}\langle\dot{J}_i,J_j\rangle\\
        &=\tr_g\nabla^2 d_p\\
        &=\Delta d_p
    \end{align*}
    The third equality uses both Proposition~\ref{hess dp in tangential}~and Proposition~\ref{hess dp in other}.
\end{proof}

Thus we have the following Bishop's theorem.
\begin{thm}[Bishop]\label{Bishop}
    Let $(M^n,g)$ be a Riemannian manifold with $\Ric\geq(n-1)Kg$.
    Let $\gamma:[0,l]\to M$ be a geodesic without cut points.
    Then $\frac{\mathscr{J}}{\mathscr{J}_K}(r)$ is nonincreasing with respective to $r$.
    ($\mathscr{J},\mathscr{J}_K$ is defined as above.)
\end{thm}
\begin{proof}
    We have
    \begin{align*}
        \frac{\partial{}}{\partial{r}}\log\frac{\mathscr{J}}{\mathscr{J}_K}&=\frac{\partial{}}{\partial{r}}\log\mathscr{J}-\frac{\partial{}}{\partial{r}}\log\mathscr{J}_K\\
        &=\Delta d_p-\Delta_Kd_K\\
        &\leq 0
    \end{align*}
    by Laplace comparison theorem.
\end{proof}

Now we can state and prove Bishop--Gromov comparison theorem, which is also known as volume comparison theorem.
\begin{thm}[Bishop--Gromov comparison]\label{Bishop Gromov}
    Let $(M^n,g)$ be a Riemannian manifold with $\Ric\geq(n-1)Kg$.
    Define geodesic annuli $A_{s,r}(p):=\{\exp_p(tv)|\ s<t<\min{r,t_v},\ v\in S_p\}$ and annuli $A^K_{r,s}$ in constant sectional curvature space $M_K$ with radii $r<s$.
    Then we have
    \[\frac{\Vol(A_{r_3,r_4}(p))}{\Vol_K(A^K_{r_3,r_4})}\leq\frac{\Vol(A_{r_1,r_2}(p))}{\Vol_K(A^K_{r_1,r_2})}\]
    provided $r_1<\min\{r_2,r_3\}<\max\{r_2,r_3\}<r_4$.
\end{thm}

\begin{cor}
    \begin{enumerate}[(1)]
        \item Let $r_1=r_3=0$ in Theorem~\ref{Bishop Gromov}, we have
        \[\frac{\Vol(B_{r_2}(p))}{\Vol_K(B_{r_2}^K)}\leq\frac{\Vol(B_{r_1}(p))}{\Vol_K(B_{r_1}^K)}\]
        provided $r_1<r_2$.
        \item Moreover, let $r_1\to 0$, we have $\Vol(B_r(p))\leq\Vol_K(B_r^K)$.
    \end{enumerate}
\end{cor}

Before proving the theorem, we need a lemma from calculus.
\begin{lem}
    If $f(t),g(t)>0$, $f/g$ is nonincreasing, then
    \[\frac{\int_s^rf(t)\d{t}}{\int_s^rg(t)\d{t}}\]
    is nonincreasing with respective to $r,s$.
\end{lem}
\begin{proof}
    We show the function is nonincreasing with respective to one variable, the other is similar.
    Let $s<r_1<r_2$, we need to show $\int_s^{r_1}f\int_s^{r_2}g\geq\int_s^{r_2}f\int_s^{r_1}g$.
    We have
    \begin{align*}
        \int_s^{r_1}f\int_s^{r_2}g-\int_s^{r_2}f\int_s^{r_1}g&=\int_s^{r_1}f\left(\int_s^{r_1}g+\int_{r_1}^{r_2}g\right)-\left(\int_s^{r_1}f+\int_{r_1}^{r_2}f\right)\int_s^{r_1}g\\
        &=\int_s^{r_1}f\int_{r_1}^{r_2}g-\int_{r_1}^{r_2}f\int_s^{r_1}g
    \end{align*}
    By Intermediate Value Theorem, there exists $s\leq t_1\leq r_1\leq t_2\leq r_2$ such that
    \[\frac{\int_s^{r_1}f}{\int_s^{r_1}g}=\frac{f(t_1)}{g(t_1)}\geq\frac{f(t_2)}{g(t_2)}=\frac{\int_{r_1}^{r_2}f}{\int_{r_1}^{r_2}g}.\]
    Hence the lemma is proved.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{Bishop Gromov}]
    We just need to show $\Vol(A_{s,r}(p))/\Vol(A_{s,r}^K)$ is nonincreasing with respective to $r,s$.
    Using geodesic polar coordinate, denote
    \[\chi(r,\theta)=\begin{cases}
        1, & r<t_\theta,\\
        0, & r\geq t_\theta,
    \end{cases}\]
    and
    \[\chi_K(t)=\begin{cases}
        1, & K\leq 0,\\
        \begin{cases}
            1, & t\leq\pi/\sqrt{K},\\
            0, & t>\pi/\sqrt{K},
        \end{cases} & K>0.
    \end{cases}\]
    Then by Bonnet--Myers theorem, $t_\theta<\pi/\sqrt{K}$ if $K>0$, then $\frac{\chi}{\chi_K}(t,\theta)$ is nonincreasing with respective to $t$.
    Now we have
    \begin{align*}
        \frac{\Vol(A_{s,r}(p))}{\Vol_K(A^K_{s,r})}&=\frac{\int_{S_p}\int_r^s\chi(r,\theta)\mathscr{J}(r,\theta)\d{r}\wedge\d{\theta^1}\wedge\cdots\wedge\d{\theta^{n-1}}}{\int_r^s\chi_K(t)\mathscr{J}_K(t)\d{t}}\\
        &=\frac{1}{\Vol{\mathbb{S}^{n-1}}}\int_{S_p}\frac{\int_r^s\chi(t,\theta)\mathscr{J}(t,\theta)\d{t}}{\int_r^s\chi_K(t)\mathscr{J}_K(t)\d{t}}\d{\theta}
    \end{align*}
    Using Theorem~\ref{Bishop}, we have $\frac{\chi\mathscr{J}}{\chi_K\mathscr{J}_K}$ is nonincreasing (with respective to $t$).
    Then the theorem follows by above lemma.
\end{proof}

As a corollary, we have another theorem of Bishop.
\begin{thm}[Bishop]
    Let Riemannian manifold $(M^n,g)$ satisfy $\Ric\geq(n-1)Kg>0$, then $\Vol(M)\leq\Vol(\mathbb{S}^n(1/\sqrt{K}))$.
    The equality holds if and only if $M$ is isometric to $\mathbb{S}^n(1/\sqrt{K})$.
\end{thm}
\begin{proof}
    The inequality holds from Bonnet--Myers theorem and volume comparison theorem.
    The equality holds if and only if the equality holds in Lapalce comparison theorem, that is, $M$ is isometric to $\mathbb{S}^n(1/\sqrt{K})$.
\end{proof}

The important application of volume comparison theorem is Cheng's maximal radius theorem.
\begin{thm}[Cheng]
    If $(M^n,g)$ is a Riemannian manifold with $\Ric\geq(n-1)Kg$, and $\operatorname{diam}(M)=\pi/\sqrt{K}$, then $M$ is isometric to $\mathbb{S}^n(1/\sqrt{K})$.
\end{thm}
\begin{proof}
    We scale the metric to let $K=1$.
    Since $M$ is compact by Bonnet--Myers theorem, there exists $p,q\in M$ such that $d(p,q)=\pi$.
    Consider $B_r(p)$ and $B_{\pi-r}(q)$, by triangle inequality, we have $B_r(p)\cap B_{\pi-r}(q)=\varnothing$.
    Hence we have
    \begin{align*}
        \Vol(M)&\geq\Vol(B_r(p))+\Vol(B_{\pi-r}(q))\\
        &=\frac{\Vol(B_r(p))}{\Vol_1(B_r^1)}\cdot\Vol_1(B_r^1)+\frac{\Vol(B_{\pi-r}(q))}{\Vol_1(B_{\pi-r}^1)}\cdot\Vol_1(B_{\pi-r}^1)\\
        &\geq\frac{\Vol(B_\pi(p))}{\Vol_1(B_\pi^1)}\cdot\Vol_1(B_r^1)+\frac{\Vol(B_\pi(q))}{\Vol_1(B_\pi^1)}\cdot\Vol_1(B_{\pi-r}^1)\\
        &=\frac{\Vol(M)}{\Vol(\mathbb{S}^n)}(\Vol_1(B_r^1)+\Vol_1(B_{\pi-r}^1))\\
        &=\Vol(M),
    \end{align*}
    where the second inequality is Bishop--Gromov comparison theorem, and last equality is $\Vol_1(B_r^1)+\Vol_1(B_{\pi-r}^1)=\Vol(\mathbb{S}^n)$ on $\mathbb{S}^n$.
    Hence the equality in Bishop--Gromov comparison theorem holds, that is, the equality in Laplace comparison theorem holds.
    Then $M$ must be isometric to $\mathbb{S}^n$.
\end{proof}

As for noncompact manifolds, volume comparison theorem has following corollary.

\begin{cor}
    Let $M$ be a complete noncompact Riemannian manifold with $\Ric\geq 0$, then $\Vol(B_r(p))\leq\omega_nr^n=\Vol_0(B_r^0)$.
\end{cor}

The corollary gives an upper bound of the growth of the volume of geodesic ball.
Moreover, the following Calabi--Yau theorem (not the one in complex geometry) gives a lower bound.
\begin{thm}[Calabi--Yau]
    Let $M$ be a complete noncompact Riemannian manifold with $\Ric\geq 0$, then $\Vol(B_r(p))\geq C(n)\Vol(B_1(p))r$.
\end{thm}
For a proof, we refer to Schoen, Yau's \emph{Lectures on Differential Geometry}, Theorem 4.1 in Chapter 1.